

# sample: abce9c19df38717374223d0c45ce2d199f77371e18f9259b9b145fe8d5a978af
import re
import base64
from dotnetfile import DotNetPE

dotnet_file = DotNetPE("D:\\samples\\Agniane")

data = dotnet_file.get_user_stream_strings()

base64_pattern = r"^(?:[a-zA-Z0-9+\/]{4})*(?:|(?:[a-zA-Z0-9+\/]{3}=)|(?:[a-zA-Z0-9+\/]{2}==)|(?:[a-zA-Z0-9+\/]{1}===))$"

matches = []

for value in data:
    if re.search(base64_pattern, value):
        matches.append(value)

def is_ascii(s):
    return all(ord(c) < 128 for c in s)


for base64_encoded_string in matches:
    try:
        decoded_bytes = base64.b64decode(base64_encoded_string)
        decoded_string = decoded_bytes.decode("utf-8")
        
        if is_ascii(decoded_string) and decoded_string.startswith("http"):
            decoded_string = re.sub(r'\(|\)', '', decoded_string)
            print("Host Name:", decoded_string)
    except UnicodeDecodeError:
        pass  
